import * as React from 'react';
import MuiGridList from '@material-ui/core/GridList';
import GridListTile from '@material-ui/core/GridListTile';
import { makeStyles } from '@material-ui/core/styles';
import withWidth, { WithWidth } from '@material-ui/core/withWidth';
import {
    linkToRecord,
    NumberField,
    useListContext,
    DatagridProps,
    Identifier,
    ReferenceField,
    useUpdate,
    useNotify,
    useRefresh,
    useRedirect
} from 'react-admin';
import { Link } from 'react-router-dom';
import { Breakpoint } from '@material-ui/core/styles/createBreakpoints';
import { ChevronLeft, ChevronRight } from '@material-ui/icons';

const useStyles = makeStyles(theme => ({
    gridList: {
        margin: 0,
    },
    tileBar: {
        background:
            'linear-gradient(to top, rgba(0,0,0,0.8) 0%,rgba(0,0,0,0.4) 70%,rgba(0,0,0,0) 100%)',
    },
    placeholder: {
        backgroundColor: theme.palette.grey[300],
        height: '100%',
    },
    price: {
        display: 'inline',
        fontSize: '1em',
    },
    link: {
        color: '#fff',
    },
}));

const getColsForWidth = (width: Breakpoint) => {
    if (width === 'xs') return 2;
    if (width === 'sm') return 3;
    if (width === 'md') return 3;
    if (width === 'lg') return 5;
    return 6;
};

const times = (nbChildren: number, fn: (key: number) => any) =>
    Array.from({ length: nbChildren }, (_, key) => fn(key));

const LoadingGridList = (props: GridProps & { nbItems?: number }) => {
    const { width, nbItems = 20 } = props;
    const classes = useStyles();
    return (
        <MuiGridList
            cellHeight={180}
            cols={getColsForWidth(width)}
            className={classes.gridList}
        >
            {' '}
            {times(nbItems, key => (
                <GridListTile key={key}>
                    <div className={classes.placeholder} />
                </GridListTile>
            ))}
        </MuiGridList>
    );
};

const CategoryNameField = (props: any) => {
    const { record } = props;
    return record ? (
        <div style={{
            maxWidth: '100%',
            display: '-webkit-box',
            WebkitBoxOrient: 'vertical',
            WebkitLineClamp: 1,
            overflow: 'hidden',
            textOverflow: 'ellipsis',
        }}>
            {record.name}
        </div>
    ) : null;
};

const LoadedGridList = (props: any) => {
    const { width } = props;
    const { ids, data, basePath } = useListContext();
    const classes = useStyles();
    const [update] = useUpdate();
    const notify = useNotify();
    const refresh = useRefresh();
    const redirect = useRedirect();

    if (!ids || !data) return null;

    const handleUpdatePosition = (record: any, data: any) => {
        update('product', record.id, data, record);
        notify(`更新しました`);
        setTimeout(() => {
            redirect('list', 'product');
            refresh();
        }, 200);
    }

    return (
        <div style={{}}>
            {ids.map((id: Identifier) => (
                <div key={id} style={{ display: 'inline-block', width: '20%', position: 'relative', margin: 2 }}>
                    <div style={{ height: 200 }}>
                        <Link
                            key={id}
                            to={linkToRecord(basePath, data[id].id)}
                            style={{ display: 'block', textDecoration: 'none', color: '#fff', height: '100%', width: '100%', overflowY: 'hidden' }}
                        >
                            {data[id].image ? (
                                <img style={{ width: 'auto', height: '100%', margin: 'auto', display: 'flex', alignSelf: 'center' }} src={data[id].image} alt="" />
                            ) : (
                                <svg style={{ width: 'auto', height: '100%', margin: 'auto', display: 'flex', alignSelf: 'center' }}
                                    version="1.0" xmlns="http://www.w3.org/2000/svg"
                                    width="1000.000000pt" height="800.000000pt" viewBox="0 0 1000.000000 800.000000"
                                    preserveAspectRatio="xMidYMid meet">

                                    <g transform="translate(0.000000,800.000000) scale(0.100000,-0.100000)"
                                        fill="#000000" stroke="none">
                                        <path d="M3490 6320 l0 -80 -160 0 -160 0 0 -225 0 -225 50 0 c49 0 50 1 50
                   30 l0 30 110 0 110 0 0 -145 0 -145 50 0 50 0 0 145 0 145 115 0 115 0 0 -25
                   c0 -23 3 -25 50 -25 l50 0 0 220 0 220 -165 0 -165 0 0 80 0 80 -50 0 -50 0 0
                   -80z m0 -275 l0 -115 -110 0 -110 0 0 115 0 115 110 0 110 0 0 -115z m330 0
                   l0 -115 -115 0 -115 0 0 115 0 115 115 0 115 0 0 -115z"/>
                                        <path d="M1590 6351 c-11 -23 -49 -71 -83 -107 l-62 -65 -53 26 c-81 39 -108
                   42 -132 14 -26 -32 -25 -38 11 -51 17 -6 52 -21 77 -34 56 -29 68 -29 81 -7 9
                   17 10 17 28 0 23 -20 54 -22 71 -5 9 9 12 -17 12 -120 l0 -132 40 0 c39 0 40
                   -1 40 -35 l0 -35 -180 0 -180 0 0 -35 0 -35 180 0 180 0 0 -90 0 -90 50 0 50
                   0 0 90 0 90 185 0 185 0 0 35 0 35 -185 0 -185 0 0 35 0 35 180 0 180 0 0 30
                   0 30 -115 0 -115 0 0 30 0 30 90 0 90 0 0 30 0 30 -90 0 -90 0 0 30 0 30 90 0
                   90 0 0 30 0 30 -90 0 -90 0 0 30 0 30 100 0 100 0 0 30 0 30 -95 0 -95 0 26
                   41 c14 22 24 42 22 44 -2 1 -25 6 -53 9 l-50 7 -25 -48 c-23 -45 -28 -48 -68
                   -51 l-43 -3 21 41 c12 23 20 44 17 46 -2 2 -24 7 -49 10 -46 6 -46 6 -68 -35z
                   m160 -151 c0 -30 -1 -30 -55 -30 -54 0 -55 0 -55 30 0 30 1 30 55 30 54 0 55
                   0 55 -30z m0 -120 c0 -30 -1 -30 -55 -30 -54 0 -55 0 -55 30 0 30 1 30 55 30
                   54 0 55 0 55 -30z m0 -120 c0 -30 -1 -30 -55 -30 -54 0 -55 0 -55 30 0 30 1
                   30 55 30 54 0 55 0 55 -30z"/>
                                        <path d="M2334 6354 c-38 -96 -78 -171 -129 -250 l-55 -84 17 -35 c21 -44 40
                   -44 75 -3 l27 33 1 -227 0 -228 50 0 c40 0 50 3 50 17 0 15 1 15 18 0 44 -40
                   69 -10 103 121 14 53 22 125 26 235 l6 157 253 0 254 0 0 35 0 35 -299 0 -298
                   0 -6 -192 c-4 -168 -8 -202 -28 -263 l-24 -70 -3 283 -2 282 24 48 c19 35 25
                   41 26 25 0 -22 4 -23 75 -23 l75 0 0 -35 c0 -35 0 -35 45 -35 45 0 45 0 45 35
                   l0 35 65 0 65 0 0 -35 0 -35 50 0 50 0 0 35 0 35 70 0 70 0 0 30 0 30 -70 0
                   -70 0 0 40 0 40 -50 0 -50 0 0 -40 0 -40 -65 0 -65 0 0 40 0 40 -45 0 -45 0 0
                   -40 0 -40 -75 0 -75 0 12 25 c14 31 5 41 -45 50 -36 7 -38 6 -53 -31z"/>
                                        <path d="M1324 6355 c-9 -14 -15 -27 -13 -28 36 -21 144 -67 158 -67 16 0 58
                   47 49 55 -2 1 -31 17 -65 34 -77 38 -107 39 -129 6z"/>
                                        <path d="M1440 6083 c0 -5 -39 -50 -86 -101 l-87 -93 23 -24 c13 -14 32 -25
                   41 -25 19 0 179 175 179 195 -1 29 -70 76 -70 48z"/>
                                        <path d="M2540 5795 l0 -235 45 0 45 0 0 75 0 75 50 0 50 0 0 -70 0 -70 45 0
                   45 0 0 70 0 70 50 0 50 0 0 -45 0 -45 -46 0 c-43 0 -46 -2 -40 -22 3 -13 6
                   -26 6 -30 0 -15 125 -8 148 8 22 15 22 19 22 235 l0 219 -235 0 -235 0 0 -235z
                   m190 140 l0 -35 -50 0 -50 0 0 35 0 35 50 0 50 0 0 -35z m190 0 l0 -35 -50 0
                   -50 0 0 35 0 35 50 0 50 0 0 -35z m-190 -130 l0 -35 -50 0 -50 0 0 35 0 35 50
                   0 50 0 0 -35z m190 0 l0 -35 -50 0 -50 0 0 35 0 35 50 0 50 0 0 -35z"/>
                                        <path d="M5654 5374 c-44 -21 -70 -76 -84 -172 -25 -169 -2 -316 59 -379 38
                   -40 56 -28 22 15 -59 73 -77 168 -61 312 13 121 24 153 61 185 61 51 110 23
                   128 -72 17 -89 59 -162 115 -200 70 -48 134 -63 296 -73 142 -8 201 -20 228
                   -45 11 -10 8 -17 -22 -40 -44 -34 -149 -175 -172 -233 -1 -1 -16 11 -33 27
                   -75 70 -202 105 -327 89 -89 -10 -138 -27 -327 -109 -87 -38 -178 -75 -204
                   -82 -63 -16 -78 -41 -59 -96 77 -225 468 -362 705 -248 28 13 51 22 51 19 0
                   -3 -36 -73 -79 -156 -52 -98 -77 -157 -72 -165 6 -9 37 41 97 155 48 93 109
                   209 136 258 26 49 48 91 48 93 0 2 -27 -28 -60 -66 -97 -112 -149 -140 -281
                   -148 -158 -10 -338 52 -442 152 -48 46 -93 125 -84 149 3 7 25 18 48 25 24 7
                   114 43 199 81 85 37 184 77 220 88 174 53 304 34 419 -62 24 -20 44 -36 46
                   -36 2 0 28 37 59 83 65 97 84 119 158 179 64 52 141 82 213 82 50 0 82 -13
                   210 -80 69 -38 173 -51 276 -36 77 11 239 63 267 85 33 26 2 22 -105 -16 -94
                   -32 -137 -41 -209 -45 -114 -6 -172 7 -260 60 -68 41 -151 68 -189 62 -78 -11
                   -102 -17 -147 -40 -29 -15 -53 -22 -57 -16 -8 12 -59 38 -91 45 -14 3 -68 8
                   -120 12 -203 12 -252 23 -323 72 -50 35 -84 94 -96 170 -11 71 -22 96 -53 117
                   -28 20 -64 20 -104 0z"/>
                                        <path d="M5094 5058 c12 -62 25 -112 29 -110 11 3 11 7 -8 117 -11 65 -22 105
                   -30 105 -9 0 -6 -30 9 -112z"/>
                                        <path d="M8307 5120 c-16 -19 -32 -57 -42 -103 -36 -164 -98 -207 -256 -177
                   -71 14 -197 14 -248 0 -89 -24 -150 -110 -151 -212 0 -56 31 -161 51 -174 20
                   -12 22 7 6 42 -75 157 -17 292 140 324 45 10 78 9 177 -5 97 -14 130 -15 164
                   -6 61 17 108 68 127 139 36 132 41 146 66 164 34 26 75 15 95 -24 24 -47 30
                   -198 11 -290 -16 -75 -61 -179 -98 -227 -11 -13 -19 -33 -19 -44 0 -16 6 -12
                   31 19 83 103 135 277 125 414 -12 148 -36 190 -110 190 -37 0 -48 -5 -69 -30z"/>
                                        <path d="M7507 5012 c-39 -16 -18 -27 45 -24 51 3 74 -1 105 -17 39 -19 93
                   -73 93 -92 0 -5 7 -9 15 -9 8 0 15 4 15 9 0 19 -48 77 -88 105 -34 24 -54 31
                   -105 33 -34 1 -70 -1 -80 -5z"/>
                                        <path d="M4715 4918 c17 -78 65 -128 122 -128 33 0 74 29 85 60 3 10 9 10 25
                   1 36 -19 50 -12 21 12 -15 12 -30 34 -33 50 -9 33 -25 36 -25 3 0 -37 -21 -86
                   -42 -97 -48 -26 -108 17 -128 92 -13 48 -35 53 -25 7z"/>
                                        <path d="M4551 4896 c-47 -50 -21 -136 41 -136 37 0 88 48 88 83 0 68 -83 102
                   -129 53z m95 -25 c16 -31 4 -62 -29 -81 -35 -20 -61 -4 -65 39 -7 65 67 97 94
                   42z"/>
                                        <path d="M4440 4885 c0 -43 -21 -125 -33 -125 -6 0 -37 27 -69 59 -32 33 -60
                   56 -63 50 -6 -9 61 -99 74 -99 3 -1 16 -9 29 -20 22 -18 22 -21 8 -49 -18 -33
                   -20 -51 -8 -51 11 0 58 96 71 145 14 50 14 115 1 115 -5 0 -10 -11 -10 -25z"/>
                                        <path d="M3996 4873 c-3 -3 -6 -16 -6 -29 0 -18 -7 -23 -45 -28 -25 -4 -45
                   -12 -45 -18 0 -7 16 -8 45 -4 51 8 49 11 60 -107 5 -46 11 -67 18 -64 7 3 11
                   10 9 17 -2 7 -6 48 -9 91 l-6 78 43 3 c24 2 45 9 48 15 3 10 -8 11 -42 7 -42
                   -6 -46 -5 -46 14 0 22 -13 36 -24 25z"/>
                                        <path d="M5127 4874 c-14 -15 -6 -34 14 -34 14 0 19 5 17 17 -3 18 -20 27 -31
                   17z"/>
                                        <path d="M2810 4783 c0 -28 58 -334 64 -341 18 -17 15 23 -13 175 -17 93 -31
                   172 -31 176 0 4 -4 7 -10 7 -5 0 -10 -8 -10 -17z"/>
                                        <path d="M3725 4760 c-39 -40 -47 -118 -16 -149 30 -30 67 -27 102 8 29 29 30
                   29 58 13 24 -13 32 -14 45 -3 9 7 13 18 10 23 -4 6 -10 6 -16 0 -15 -15 -38
                   -3 -49 24 -12 32 -25 30 -37 -5 -20 -58 -92 -78 -107 -30 -16 49 28 129 71
                   129 13 0 29 -9 36 -20 15 -23 28 -26 28 -6 0 51 -81 62 -125 16z"/>
                                        <path d="M3469 4721 c-77 -77 8 -191 119 -161 38 10 71 35 60 45 -3 3 -18 -1
                   -34 -10 -45 -23 -101 -19 -129 10 -14 13 -25 36 -25 50 0 31 41 75 70 75 12 0
                   30 -5 41 -10 43 -23 9 -70 -52 -70 -21 0 -39 -4 -39 -10 0 -5 20 -10 45 -10
                   51 0 85 25 85 63 0 61 -90 78 -141 28z"/>
                                        <path d="M3242 4695 c-20 -25 -20 -25 -51 -8 -29 17 -33 17 -60 2 -21 -12 -32
                   -14 -40 -6 -19 19 -19 3 -1 -68 11 -38 19 -80 19 -92 1 -13 6 -23 12 -23 11 0
                   8 55 -7 114 -6 24 23 66 45 66 27 0 62 -48 71 -99 6 -30 12 -57 15 -59 13 -14
                   16 12 7 65 -15 89 12 129 71 102 31 -14 47 -48 47 -100 0 -28 4 -39 13 -36 16
                   5 10 82 -9 119 -28 54 -98 66 -132 23z"/>
                                        <path d="M6987 4690 c-44 -14 -94 -57 -123 -106 -21 -36 -26 -57 -26 -109 1
                   -138 84 -239 202 -247 63 -4 63 18 0 24 -99 10 -173 104 -174 222 -1 105 58
                   173 172 197 99 20 203 -24 243 -103 55 -107 27 -218 -68 -273 -54 -31 -65 -45
                   -36 -45 30 0 111 63 135 105 54 95 12 249 -86 310 -43 26 -60 30 -130 32 -45
                   1 -94 -2 -109 -7z"/>
                                        <path d="M6493 4606 c-35 -17 -61 -38 -80 -67 -25 -38 -28 -52 -28 -118 1 -62
                   6 -85 25 -121 44 -79 148 -124 245 -106 43 8 125 84 125 116 0 25 -17 26 -24
                   2 -4 -10 -22 -33 -41 -52 -30 -29 -43 -34 -94 -38 -120 -9 -199 60 -208 181
                   -7 82 18 135 79 170 60 35 92 40 155 26 71 -16 119 -59 128 -114 9 -56 13 -65
                   26 -65 19 0 2 90 -25 131 -31 47 -84 71 -166 76 -54 3 -74 0 -117 -21z"/>
                                        <path d="M7052 4534 c-17 -12 -22 -25 -22 -63 0 -65 29 -94 91 -89 37 3 47 8
                   67 38 27 41 23 74 -14 108 -30 26 -89 30 -122 6z"/>
                                        <path d="M7947 4535 c-96 -24 -284 -131 -265 -150 4 -4 40 14 81 39 118 73
                   174 90 297 91 95 0 111 -3 167 -29 66 -30 135 -95 210 -196 48 -65 127 -141
                   171 -164 55 -28 39 -80 -41 -134 -151 -103 -384 -108 -586 -12 -66 32 -102 58
                   -168 123 -95 92 -91 96 -46 -63 31 -109 114 -285 142 -299 12 -7 21 -9 21 -6
                   0 3 -18 39 -40 79 -37 67 -100 223 -100 246 0 6 21 -6 47 -26 102 -78 258
                   -138 393 -150 77 -7 188 8 265 37 150 56 223 179 134 225 -47 24 -113 88 -184
                   179 -128 164 -211 215 -360 221 -48 2 -103 -2 -138 -11z"/>
                                        <path d="M6597 4468 c-47 -37 -35 -114 23 -138 27 -11 36 -11 66 3 31 15 34
                   20 34 61 0 36 -5 48 -26 65 -30 24 -72 27 -97 9z"/>
                                        <path d="M3960 4294 c-99 -51 -180 -74 -266 -74 -97 0 -106 -12 -106 -140 -1
                   -176 4 -186 235 -501 l98 -134 -28 -9 c-35 -11 -53 -25 -53 -41 0 -28 921
                   -868 947 -863 10 2 -78 88 -248 243 -235 213 -435 397 -612 563 -67 62 -65 75
                   12 76 42 1 55 -4 80 -28 16 -15 35 -41 41 -57 10 -24 18 -29 47 -29 71 0 137
                   -50 150 -113 6 -29 29 -47 62 -47 34 0 80 -48 92 -96 15 -59 41 -61 28 -2 -17
                   72 -73 128 -129 128 -31 0 -24 24 13 42 17 8 50 24 72 35 22 11 69 28 105 37
                   36 10 85 29 109 42 24 13 47 22 51 19 4 -2 10 -37 12 -76 4 -57 11 -79 35
                   -112 16 -24 39 -43 51 -45 29 -4 28 6 -3 30 -37 29 -47 54 -55 135 -6 61 -12
                   78 -38 108 -40 45 -48 78 -34 131 10 38 9 48 -13 96 -29 62 -31 97 -8 145 14
                   31 75 74 87 62 2 -2 10 -51 16 -109 22 -209 86 -466 165 -670 18 -47 59 -150
                   90 -230 31 -80 63 -155 71 -167 13 -21 12 -23 -16 -38 l-30 -16 -21 48 c-35
                   80 -104 262 -139 366 -31 90 -50 121 -50 79 0 -40 152 -450 181 -488 11 -14 1
                   -24 -25 -24 -33 0 -162 -65 -180 -91 -15 -22 -14 -26 11 -68 43 -74 95 -133
                   106 -122 8 8 4 18 -10 33 -11 13 -38 49 -58 82 -30 47 -34 60 -24 68 29 19 94
                   50 131 64 l39 14 15 -38 c13 -32 62 -136 71 -153 2 -3 -33 -20 -77 -38 -97
                   -41 -100 -52 -37 -149 65 -99 141 -183 284 -315 182 -166 228 -199 398 -282
                   200 -97 475 -189 498 -166 12 12 22 8 -128 51 -206 59 -425 158 -549 248 -98
                   72 -300 258 -383 351 -69 80 -150 197 -141 206 5 5 316 134 341 142 22 7 71
                   -47 124 -136 98 -166 271 -298 528 -404 154 -64 422 -137 501 -137 38 0 28 19
                   -13 25 -236 36 -553 153 -733 270 -241 157 -366 392 -346 650 7 97 18 139 58
                   226 27 59 32 65 55 61 22 -4 19 1 -25 47 -85 90 -151 220 -173 338 -6 32 -9
                   103 -6 158 11 217 123 408 285 483 147 69 340 6 397 -131 9 -21 22 -40 31 -44
                   8 -3 45 8 82 25 37 17 96 38 132 48 85 22 252 22 344 0 70 -17 188 -71 241
                   -111 55 -42 72 -41 94 4 24 46 67 81 136 112 41 18 68 22 150 22 168 -1 266
                   -56 335 -185 31 -57 34 -72 38 -171 5 -116 17 -147 27 -70 9 70 8 68 77 106
                   119 66 202 90 308 90 108 0 173 -19 269 -77 67 -41 166 -142 205 -209 92 -156
                   116 -399 62 -604 -12 -45 -12 -53 0 -53 30 0 58 179 51 334 -8 196 -68 345
                   -188 465 -162 162 -381 216 -579 142 -46 -17 -110 -46 -141 -65 l-57 -34 -11
                   55 c-14 72 -65 165 -114 209 -72 65 -137 88 -264 92 -84 3 -124 0 -158 -12
                   -62 -21 -137 -77 -160 -120 -11 -20 -22 -36 -25 -36 -4 0 -22 12 -41 26 -56
                   42 -163 92 -245 115 -154 42 -360 22 -501 -50 l-60 -30 -11 33 c-30 82 -146
                   166 -249 182 -148 22 -326 -90 -414 -262 -57 -109 -74 -182 -73 -314 1 -176
                   43 -303 143 -427 l51 -63 -24 -35 c-62 -91 -96 -274 -77 -412 7 -48 17 -95 23
                   -106 8 -15 7 -18 -4 -15 -7 2 -20 20 -28 39 -8 19 -33 70 -55 114 -37 74 -43
                   80 -70 79 -17 0 -41 -4 -55 -8 -25 -7 -27 -3 -83 137 -99 251 -167 446 -202
                   581 -37 145 -75 356 -75 420 0 22 -7 49 -15 59 -12 17 -18 18 -49 7 -41 -13
                   -95 -70 -102 -109 -6 -27 -9 -24 -124 88 -183 181 -219 237 -250 386 -30 148
                   -80 168 -230 89z m163 4 c10 -8 29 -58 46 -120 41 -154 67 -193 265 -390 140
                   -140 180 -206 163 -267 -10 -39 -2 -96 18 -128 17 -25 9 -34 -48 -58 -49 -20
                   -74 -20 -57 0 7 8 10 24 7 36 -3 12 0 22 9 26 10 4 12 16 8 47 -14 89 -59 145
                   -262 324 -89 79 -113 119 -175 296 -78 227 -78 225 -59 236 24 13 65 12 85 -2z
                   m-142 -61 c-14 -14 -84 -20 -76 -6 4 5 15 7 24 4 11 -3 25 3 37 16 11 13 20
                   16 22 9 3 -7 -1 -17 -7 -23z m29 -16 c0 -5 3 -17 7 -27 4 -11 3 -15 -4 -11
                   -14 9 -24 47 -12 47 5 0 9 -4 9 -9z m-130 -21 c0 -5 -4 -10 -10 -10 -5 0 -10
                   5 -10 10 0 6 5 10 10 10 6 0 10 -4 10 -10z m-35 -10 c4 -6 -5 -10 -19 -10 -14
                   0 -26 5 -26 10 0 6 9 10 19 10 11 0 23 -4 26 -10z m-214 -27 c-8 -15 -10 -15
                   -11 -2 0 17 10 32 18 25 2 -3 -1 -13 -7 -23z m326 -29 c-3 -3 -12 -4 -19 -1
                   -8 3 -5 6 6 6 11 1 17 -2 13 -5z m-252 -14 c-3 -5 -13 -10 -21 -10 -8 0 -14 5
                   -14 10 0 6 9 10 21 10 11 0 17 -4 14 -10z m326 -51 c4 -13 7 -40 7 -59 1 -31
                   -1 -28 -18 25 -23 72 -23 68 -8 63 7 -3 15 -15 19 -29z m-291 -11 c0 -11 -29
                   -23 -36 -15 -3 3 -4 10 0 15 7 11 36 11 36 0z m120 -29 c0 -5 -4 -9 -10 -9 -5
                   0 -10 7 -10 16 0 8 5 12 10 9 6 -3 10 -10 10 -16z m-35 -9 c-3 -5 -10 -10 -16
                   -10 -5 0 -9 5 -9 10 0 6 7 10 16 10 8 0 12 -4 9 -10z m-35 -30 c8 -5 13 -10
                   10 -11 -3 0 -15 -2 -27 -5 -22 -4 -30 6 -16 19 9 9 15 9 33 -3z m208 -28 c6
                   -18 -15 -14 -22 4 -4 10 -1 14 6 12 6 -2 14 -10 16 -16z m104 3 c4 -5 7 -19 7
                   -30 0 -14 -2 -16 -6 -5 -9 21 -30 40 -37 33 -3 -4 -6 -1 -6 6 0 14 31 11 42
                   -4z m-212 -15 c0 -5 -4 -10 -10 -10 -5 0 -10 5 -10 10 0 6 5 10 10 10 6 0 10
                   -4 10 -10z m-173 -72 c-3 -7 -5 -2 -5 12 0 14 2 19 5 13 2 -7 2 -19 0 -25z
                   m228 -8 c3 -5 1 -10 -4 -10 -6 0 -11 5 -11 10 0 6 2 10 4 10 3 0 8 -4 11 -10z
                   m-195 -35 c13 -14 21 -27 18 -30 -7 -7 -58 34 -58 46 0 16 16 10 40 -16z m185
                   -75 c3 -5 1 -10 -4 -10 -6 0 -11 5 -11 10 0 6 2 10 4 10 3 0 8 -4 11 -10z m42
                   -16 c-9 -9 -28 6 -21 18 4 6 10 6 17 -1 6 -6 8 -13 4 -17z m287 -90 c23 -16
                   26 -23 15 -29 -8 -5 -11 -5 -7 0 4 4 -19 28 -52 51 -32 24 -64 54 -71 66 -8
                   15 6 7 37 -22 27 -25 62 -55 78 -66z m-385 31 c0 -5 -11 4 -24 20 -14 17 -25
                   35 -25 40 0 6 11 -3 25 -20 13 -16 24 -34 24 -40z m139 -4 c3 -8 -1 -12 -9 -9
                   -7 2 -15 10 -17 17 -3 8 1 12 9 9 7 -2 15 -10 17 -17z m-88 -21 c14 -10 23
                   -21 20 -23 -3 -3 -18 6 -35 19 -35 28 -22 32 15 4z m440 -10 c0 -5 -2 -10 -4
                   -10 -3 0 -8 5 -11 10 -3 6 -1 10 4 10 6 0 11 -4 11 -10z m-469 -25 c-1 -15
                   -24 -12 -29 3 -3 9 2 13 12 10 10 -1 17 -7 17 -13z m471 -60 c29 -34 20 -37
                   -13 -5 -18 16 -40 30 -50 30 -10 0 -21 5 -24 10 -3 6 1 10 10 10 10 0 13 5 9
                   13 -8 14 42 -28 68 -58z m-277 -15 c3 -5 -1 -10 -9 -10 -8 0 -18 5 -21 10 -3
                   6 1 10 9 10 8 0 18 -4 21 -10z m404 -75 c0 -5 -6 1 -14 15 -8 14 -14 30 -14
                   35 0 6 6 -1 14 -15 8 -14 14 -29 14 -35z m-229 -7 c0 -6 -7 -5 -15 2 -8 7 -15
                   17 -15 22 0 6 7 5 15 -2 8 -7 15 -17 15 -22z m-125 -18 c3 -5 1 -10 -4 -10 -6
                   0 -11 5 -11 10 0 6 2 10 4 10 3 0 8 -4 11 -10z m310 -52 c-2 -29 -14 -51 -16
                   -27 0 8 -3 32 -5 54 -4 36 -4 38 9 20 7 -11 13 -32 12 -47z m-122 38 c4 -10 1
                   -13 -9 -9 -7 3 -14 9 -14 14 0 14 17 10 23 -5z m-18 -66 c3 -5 2 -10 -4 -10
                   -5 0 -13 5 -16 10 -3 6 -2 10 4 10 5 0 13 -4 16 -10z m75 -20 c0 -5 -4 -10
                   -10 -10 -5 0 -10 5 -10 10 0 6 5 10 10 10 6 0 10 -4 10 -10z m-140 -40 c0 -5
                   -2 -10 -4 -10 -3 0 -8 5 -11 10 -3 6 -1 10 4 10 6 0 11 -4 11 -10z m80 -24 c0
                   -3 -4 -8 -10 -11 -5 -3 -10 -1 -10 4 0 6 5 11 10 11 6 0 10 -2 10 -4z m-15
                   -46 c-3 -5 -14 -10 -23 -9 -14 0 -13 2 3 9 27 11 27 11 20 0z m885 -705 c23
                   -47 40 -89 36 -92 -8 -8 -157 -73 -167 -73 -8 0 -70 125 -83 167 -6 18 3 25
                   66 52 40 17 80 31 89 31 11 0 31 -29 59 -85z"/>
                                        <path d="M5536 3766 c-46 -17 -61 -30 -51 -46 5 -8 13 -6 27 7 14 12 41 19 89
                   21 95 6 105 -4 114 -111 24 -288 137 -474 333 -547 245 -92 655 21 850 235 61
                   66 122 185 129 249 7 62 -11 59 -25 -5 -33 -140 -157 -288 -308 -367 -380
                   -196 -738 -142 -877 133 -29 58 -57 171 -71 284 -17 139 -27 153 -113 158 -34
                   2 -74 -3 -97 -11z"/>
                                        <path d="M5456 3653 c-22 -137 6 -300 76 -443 83 -169 257 -304 449 -350 310
                   -73 671 -38 899 87 59 32 170 115 195 145 135 164 186 276 200 439 7 74 6 77
                   -21 108 -51 56 -212 69 -222 18 -3 -16 -1 -17 16 -8 29 16 116 14 157 -3 42
                   -18 49 -43 42 -134 -9 -127 -98 -304 -205 -411 -200 -200 -527 -284 -922 -237
                   -211 25 -345 88 -465 219 -123 132 -179 287 -178 490 1 116 -9 152 -21 80z"/>
                                        <path d="M7700 3175 c0 -9 19 -36 41 -60 38 -41 41 -48 35 -82 -21 -115 -80
                   -252 -167 -386 l-44 -68 -43 48 c-46 51 -112 156 -112 177 0 7 40 36 89 65
                   103 61 234 173 239 204 3 16 -10 8 -57 -35 -134 -124 -363 -252 -576 -322
                   -202 -67 -389 -96 -612 -96 -365 0 -698 92 -950 261 -40 27 -77 49 -83 49 -24
                   0 -6 -20 58 -63 269 -181 546 -262 930 -274 179 -6 182 -6 182 -28 0 -31 34
                   -152 57 -205 12 -25 37 -69 57 -99 20 -29 36 -55 36 -58 0 -3 -44 -3 -97 1
                   -112 8 -187 37 -262 102 -55 48 -117 142 -136 209 -23 75 -38 91 -32 32 11
                   -114 124 -265 246 -326 54 -28 79 -34 184 -42 261 -22 439 13 630 123 204 118
                   432 444 479 685 6 32 12 59 13 61 1 1 32 -9 69 -23 66 -25 136 -33 136 -16 0
                   10 -34 21 -66 21 -40 0 -143 61 -188 111 -47 52 -56 58 -56 34z m-297 -428
                   c15 -29 53 -84 86 -124 l60 -71 -66 -72 c-77 -83 -205 -179 -212 -158 -2 7
                   -25 37 -51 66 -48 54 -106 146 -146 231 l-22 49 91 33 c71 25 164 65 233 98 1
                   1 13 -23 27 -52z m-343 -163 c34 -79 92 -164 161 -239 l39 -42 -57 -26 c-98
                   -43 -194 -68 -289 -74 l-92 -6 -32 44 c-48 65 -97 173 -119 264 -22 86 -19 95
                   30 95 33 0 234 36 274 49 49 15 50 14 85 -65z"/>
                                        <path d="M4437 2983 c-14 -13 -5 -23 111 -130 325 -297 327 -299 336 -284 3 4
                   -70 78 -162 162 -92 84 -192 177 -223 206 -31 29 -59 50 -62 46z"/>
                                        <path d="M5622 2708 c-17 -17 -15 -35 5 -42 21 -8 36 6 31 30 -4 22 -20 28
                   -36 12z"/>
                                        <path d="M8380 2648 c-36 -101 -119 -256 -182 -338 -72 -96 -214 -233 -306
                   -293 -128 -85 -297 -158 -436 -187 -61 -12 -102 -44 -51 -38 28 3 30 1 37 -51
                   9 -60 46 -191 58 -204 19 -21 17 15 -5 100 -13 50 -25 107 -27 128 l-3 37 75
                   22 c41 12 85 26 98 30 l22 7 0 -161 c0 -120 4 -170 15 -196 16 -39 155 -221
                   204 -268 38 -37 52 -27 20 13 -90 110 -173 221 -188 251 -14 27 -20 71 -24
                   203 l-6 167 72 36 c39 19 85 43 102 53 54 33 369 119 517 141 116 17 174 -6
                   219 -90 24 -44 15 -188 -20 -340 -43 -186 -66 -256 -83 -251 -7 3 -47 8 -88
                   11 -41 4 -103 15 -137 25 -37 11 -69 15 -80 10 -10 -5 -21 -7 -26 -7 -20 5
                   -44 -134 -33 -192 6 -29 12 -35 49 -45 23 -6 54 -12 70 -13 15 -1 27 -5 27 -9
                   0 -8 134 -47 174 -51 34 -3 35 -1 66 162 11 58 31 143 45 190 69 230 95 452
                   60 521 -57 113 -133 133 -340 90 -93 -20 -247 -61 -291 -78 -10 -4 26 35 80
                   87 106 101 191 208 248 311 40 72 108 238 108 263 0 34 -18 13 -40 -46z m-105
                   -1222 c32 -14 34 -17 25 -40 -5 -14 -14 -55 -21 -91 l-11 -66 -37 7 c-85 16
                   -85 15 -78 105 4 44 9 84 12 90 9 14 71 11 110 -5z m182 -27 c21 -7 33 -17 33
                   -29 0 -24 -31 -172 -39 -186 -4 -8 -28 -5 -80 8 -41 10 -76 20 -78 22 -4 3 34
                   174 41 185 7 11 90 11 123 0z"/>
                                        <path d="M5866 2524 c-23 -23 -15 -39 20 -39 24 0 29 4 29 25 0 30 -26 38 -49
                   14z"/>
                                        <path d="M5550 2425 c-18 -21 -5 -45 25 -45 14 0 28 7 31 15 7 17 -12 45 -31
                   45 -7 0 -18 -7 -25 -15z"/>
                                        <path d="M7255 1844 c-127 -29 -166 -38 -204 -50 -24 -8 -52 -12 -63 -8 -26 8
                   -117 -5 -130 -20 -7 -8 -59 -9 -182 -5 -94 3 -179 2 -188 -3 -23 -11 -23 -69
                   -3 -157 19 -79 28 -91 70 -91 43 0 285 78 285 92 0 10 -36 7 -72 -7 -10 -4
                   -18 -3 -18 3 0 11 9 14 62 26 22 5 30 1 45 -24 20 -35 32 -36 99 -13 37 12 90
                   16 213 18 119 1 166 4 169 13 2 7 8 10 13 6 13 -7 10 110 -4 171 -11 46 -15
                   50 -42 52 -17 0 -39 -1 -50 -3z m-285 -94 c-8 -5 -19 -10 -25 -10 -5 0 -3 5 5
                   10 8 5 20 10 25 10 6 0 3 -5 -5 -10z m308 -9 c3 -8 -1 -12 -9 -9 -7 2 -15 10
                   -17 17 -3 8 1 12 9 9 7 -2 15 -10 17 -17z m-358 -1 c-8 -5 -24 -10 -35 -10
                   -17 0 -17 2 -5 10 8 5 24 10 35 10 17 0 17 -2 5 -10z m295 -22 c-11 -6 -26
                   -18 -32 -26 -8 -10 -13 -11 -13 -4 0 7 -14 12 -32 12 -26 0 -30 -3 -18 -11 12
                   -9 12 -10 1 -7 -48 13 10 45 84 47 27 0 28 -1 10 -11z m-305 -8 c0 -5 -4 -10
                   -10 -10 -5 0 -10 5 -10 10 0 6 5 10 10 10 6 0 10 -4 10 -10z m370 -21 c0 -5
                   -4 -9 -10 -9 -5 0 -10 7 -10 16 0 8 5 12 10 9 6 -3 10 -10 10 -16z m-65 1 c3
                   -5 1 -10 -4 -10 -6 0 -11 5 -11 10 0 6 2 10 4 10 3 0 8 -4 11 -10z m-390 -39
                   c-3 -6 -14 -11 -23 -11 -13 0 -13 2 4 14 21 15 30 14 19 -3z m100 -1 c3 -5 2
                   -10 -4 -10 -5 0 -13 5 -16 10 -3 6 -2 10 4 10 5 0 13 -4 16 -10z m-365 -34 c0
                   -3 -4 -8 -10 -11 -5 -3 -10 -1 -10 4 0 6 5 11 10 11 6 0 10 -2 10 -4z m14 -41
                   c3 -8 1 -15 -3 -15 -5 0 -11 7 -15 15 -3 8 -1 15 3 15 5 0 11 -7 15 -15z"/>
                                        <path d="M8006 1764 c-99 -19 -170 -44 -158 -56 6 -6 40 -1 93 12 46 12 114
                   24 152 27 l69 6 -4 -123 c-2 -85 0 -124 8 -127 8 -3 13 35 16 124 3 70 3 134
                   0 141 -5 16 -86 14 -176 -4z"/>
                                        <path d="M6197 1743 c-3 -5 35 -107 84 -228 50 -121 108 -267 129 -324 39
                   -102 54 -130 65 -119 9 8 -104 305 -236 620 -23 56 -33 67 -42 51z"/>
                                        <path d="M7829 1678 c-2 -37 1 -50 23 -108 54 -142 167 -340 194 -340 19 0 19
                   1 -22 61 -40 58 -138 257 -149 302 -4 15 -11 30 -16 33 -5 3 -9 21 -9 40 0 37
                   -19 48 -21 12z"/>
                                        <path d="M7015 1464 c-203 -35 -384 -63 -402 -64 -28 0 -32 4 -40 37 -9 40
                   -33 57 -33 24 0 -11 8 -37 17 -57 l18 -36 55 7 c81 9 285 41 445 70 77 14 189
                   34 248 44 60 10 114 24 120 30 19 19 -41 11 -428 -55z"/>
                                        <path d="M6125 1368 c3 -13 14 -63 25 -111 22 -99 63 -187 85 -187 12 0 10 10
                   -10 50 -14 28 -37 100 -51 160 -18 76 -30 110 -40 110 -10 0 -13 -7 -9 -22z"/>
                                    </g>
                                </svg>
                            )}

                        </Link>
                        <div style={{ position: 'absolute', bottom: 0, width: '100%' }}>
                            <div style={{
                                display: 'flex',
                                flexDirection: 'row',
                                justifyContent: 'space-between',
                                padding: 10,
                                background: 'linear-gradient(to top, rgba(0,0,0,0.8) 0%,rgba(0,0,0,0.4) 70%,rgba(0,0,0,0) 100%)',
                                color: '#fff',
                            }}>
                                <div style={{ width: '60%' }}>
                                    <Link
                                        key={id}
                                        to={linkToRecord(basePath, data[id].id)}
                                        style={{ textDecoration: 'none', color: '#fff' }}
                                    >
                                        <div style={{
                                            maxWidth: '100%',
                                            display: '-webkit-box',
                                            WebkitBoxOrient: 'vertical',
                                            WebkitLineClamp: 1,
                                            overflow: 'hidden',
                                            textOverflow: 'ellipsis',
                                        }}>{data[id].name}</div>
                                        <div style={{ paddingTop: 5 }}>
                                            <NumberField
                                                className={classes.price}
                                                source="price"
                                                record={data[id]}
                                                color="inherit"
                                                options={{
                                                    style: 'currency',
                                                    currency: 'JPY',
                                                }}
                                            />
                                        </div>
                                    </Link>
                                </div>
                                <div style={{ width: '30%', textAlign: 'right', color: '#fff' }}>
                                    <ReferenceField source="cat_ids" reference="category" link={false} record={data[id]}>
                                        <CategoryNameField />
                                    </ReferenceField>
                                    <div style={{
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'flex-end',
                                        paddingTop: 5
                                    }}>
                                        <span onClick={() => {
                                            handleUpdatePosition(data[id], { position_up: true })
                                        }}>
                                            <ChevronLeft
                                                style={data[id].position <= 1 ? { cursor: 'pointer', color: '#ccc' } : { cursor: 'pointer' }}
                                            />
                                        </span>
                                        <span>{data[id].position}</span>
                                        <span onClick={() => {
                                            handleUpdatePosition(data[id], { position_down: true })
                                        }}>
                                            <ChevronRight style={{ cursor: 'pointer' }} />
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            ))}
        </div>
    );
};

interface GridProps extends Omit<DatagridProps, 'width'>, WithWidth { }

const GridList = (props: WithWidth) => {
    const { width } = props;
    const { loaded } = useListContext();
    return loaded ? (
        <LoadedGridList width={width} />
    ) : (
        <LoadingGridList width={width} />
    );
};

export default withWidth()(GridList);
